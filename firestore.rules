/**
 * @fileoverview Firestore Security Rules
 * @author custom-instructions-engine
 *
 * @description
 * This ruleset allows any authenticated user to read and write to the database.
 * It's a simple rule for single-user or development environments where complex
 * role-based access control is not required.
 *
 * @philosophy
 * Core Philosophy: Simplicity and ease of use. The primary goal is to secure
 * the database from unauthenticated access while allowing any logged-in user
 * to perform all operations. This is suitable for internal tools or initial
 * development phases.
 *
 * Key Security Decisions:
 * - Authenticated Access Only: The `isSignedIn()` function ensures that no
 *   anonymous or unauthenticated user can access any data.
 * - Full Access for Authenticated Users: All collections (`items`, `customers`,
 *   `sales`, `expenses`, etc.) are open for read and write operations to any
 *   user who is signed in.
 * - Default Deny: All paths not explicitly matched are denied access, which is a
 *   Firestore security best practice.
 */
rules_version = '2';
service cloud.firestore {
  match /databases/{database}/documents {

    // --------------------------------
    // Helper Functions
    // --------------------------------

    /**
     * Checks if the user is authenticated. This is the only check needed.
     */
    function isSignedIn() {
      return request.auth != null;
    }

    // --------------------------------
    // Data Collections
    // --------------------------------

    /**
     * @description Generic rule for all collections.
     * @path /{collection}/{docId}
     * @allow (read, write) Any authenticated user can perform any operation.
     * @deny (any) Any unauthenticated user is blocked from all operations.
     */
    match /{collection}/{docId=**} {
      allow read, write: if isSignedIn();
    }
  }
}
